import marshal,lzma,gzip,bz2,binascii,zlib;exec(marshal.loads(binascii.a2b_base64(b'c2YYAABpbXBvcnQgb3Msc3lzLHRpbWUscmVxdWVzdHMKZnJvbSByZXF1ZXN0cyBpbXBvcnQgZ2V0CmltcG9ydCB1cmxsaWIucmVxdWVzdAppbXBvcnQgc2lnbmFsCmltcG9ydCB0aW1lCmZyb20gdGltZSBpbXBvcnQgc2xlZXAKIApkZWYgaGFuZGxlcihzaWdudW0sIGZyYW1lKToKCXByaW50ICgiXDAzM1swMG0iKQoJcmVzID0gaW5wdXQoIlt+XSBDdHJsK0Mgd2FzIFByZXNzZWQuIERvIHlvdSByZWFsbHkgd2FudCB0byBFeGl0PyAoeS9uKSA6ICIpCglpZiByZXMgPT0gJ3knIG9yIHJlcyA9PSAnWScgb3IgcmVzID09ICd5ZXMnIG9yIHJlcyA9PSAnWUVTJzoKCQl0cnk6CgkJCWlmIG9zLnBhdGguZXhpc3RzKCIuZGF0YWJhc2UvZGF0YS9jb25maWcuaW5pIik6CgkJCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL2NvbmZpZy5pbmkiKQoJCQllbHNlOgoJCQkJcGFzcwoJCQlpZiBvcy5wYXRoLmV4aXN0cygiLmRhdGFiYXNlL2RhdGEvcmVxdWlyZW1lbnRzLnR4dCIpOgoJCQkJb3MucmVtb3ZlKCIuZGF0YWJhc2UvZGF0YS9yZXF1aXJlbWVudHMudHh0IikKCQkJZWxzZToKCQkJCXBhc3MKCQkJaWYgb3MucGF0aC5leGlzdHMoIi5kYXRhYmFzZS9kYXRhL2JvdC5weSIpOgoJCQkJb3MucmVtb3ZlKCIuZGF0YWJhc2UvZGF0YS9ib3QucHkiKQoJCQllbHNlOgoJCQkJcGFzcwoJCWV4Y2VwdDoKCQkJcGFzcwoJCXByaW50ICgpCgkJZXhpdCgxKQogCnNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgaGFuZGxlcikKCmNscyA9ICdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicKCkZJTEVfVVJMX0kgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0RpbHVtMTI1L1RlbGVncmFtLVZpZXdzLUJPVC9tYWluLy5kYXRhYmFzZS9ib3QvYm90LnB5IgpGSUxFX1VSTF9JSSA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRGlsdW0xMjUvVGVsZWdyYW0tVmlld3MtQk9UL21haW4vLmRhdGFiYXNlL2RhdGEvQ29uZi5NYXN0ZXJYIgpGSUxFX1VSTF9JSUkgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0RpbHVtMTI1L1RlbGVncmFtLVZpZXdzLUJPVC9tYWluL3JlcXVpcmVtZW50cy50eHQiCgpVUERBVEVfTVNHID0gIiIiCgpcMDMzWzE7MzNtVHlwZSAiXDAzM1sxOzMybXB5dGhvbjMgc2V0dXAucHkiXDAzM1sxOzMzbSAmIFByZXNzIEVudGVyCgoiIiIKCmRlZiBzcHIoKToKCWw9Wyd8JywnLycsJy0nLCdcXCddCglmb3IgaSBpbiBsK2wrbDoKCQlzeXMuc3Rkb3V0LndyaXRlKCdccicnXDAzM1sxOzM3bVt+XSBcMDMzWzE7MzZtQ0hFQ0tJTkcgVEhFIElOVEVSTkVUIENPTk5FQ1RJT04gICAnK2kpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCgkJdGltZS5zbGVlcCAoMC4xKQoKZGVmIGdldGdvb2dsZShnb29nbGU9J2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vJyk6CiAgICB0cnk6CiAgICAgICAgdXJsbGliLnJlcXVlc3QudXJsb3Blbihnb29nbGUpCiAgICAgICAgcmV0dXJuIFRydWUKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiB1cGRhdGUoKToKCXByaW50ICgpCglpZiBvcy5wYXRoLmV4aXN0cygiLnZlcnNpb24udHh0Iik6CgkJb3MucmVtb3ZlKCIudmVyc2lvbi50eHQiKQoJZWxzZToKCQlwYXNzCglpZiBvcy5wYXRoLmV4aXN0cygiLmRhdGFiYXNlL2RhdGEvcmVxdWlyZW1lbnRzLnR4dCIpOgoJCW9zLnJlbW92ZSgiLmRhdGFiYXNlL2RhdGEvcmVxdWlyZW1lbnRzLnR4dCIpCgllbHNlOgoJCXBhc3MKCWlmIG9zLnBhdGguZXhpc3RzKCIuZGF0YWJhc2UvZGF0YS9ib3QucHkiKToKCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL2JvdC5weSIpCgllbHNlOgoJCXBhc3MKCXRyeToKCQlpZiBvcy5wYXRoLmV4aXN0cygiLmRhdGFiYXNlL2RhdGEvLmNhY2UudHh0Iik6CgkJCW9zLnJlbW92ZSgiLmRhdGFiYXNlL2RhdGEvLmNhY2UudHh0IikKCQkJY2FjZSA9IG9wZW4oIi5kYXRhYmFzZS9kYXRhLy5jYWNlLnR4dCIpCgkJCWNhY2Uud3JpdGUoIi4iKQoJCQljYWNlLmNsb3NlKCkKCQllbHNlOgoJCQljYWNlID0gb3BlbigiLmRhdGFiYXNlL2RhdGEvLmNhY2UudHh0IiwgInciKQoJCQljYWNlLndyaXRlKCIuIikKCQkJY2FjZS5jbG9zZSgpCglleGNlcHQ6CgkJcGFzcwoJaWYgb3MucGF0aC5leGlzdHMoIi5kYXRhYmFzZS9kYXRhL2NvbmZpZy5pbmkiKToKCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL2NvbmZpZy5pbmkiKQoJZWxzZToKCQlwYXNzCglvcy5zeXN0ZW0oY2xzKQoJc291cmNlID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRGlsdW0xMjUvVGVsZWdyYW0tVmlld3MtQk9UL21haW4vc2V0dXAucHkiKS50ZXh0Cgl2ZXJfZmlsZSA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0RpbHVtMTI1L1RlbGVncmFtLVZpZXdzLUJPVC9tYWluLy52ZXJzaW9uLnR4dCIpLnRleHQKCXNldCA9IG9wZW4oInNldHVwLnB5IiwgInciKQoJdmVyRiA9IG9wZW4oIi52ZXJzaW9uLnR4dCIsICJ3IikKCXNldC53cml0ZShzb3VyY2UpCgl2ZXJGLndyaXRlKHZlcl9maWxlKQoJc2V0LmNsb3NlKCkKCXZlckYuY2xvc2UoKQoJcHJpbnQgKCkKCXByaW50IChVUERBVEVfTVNHKQoJcHJpbnQgKCkKCmRlZiBzZXR1cCgpOgoJb3Muc3lzdGVtKGNscykKCWlmIHN5cy5hcmd2WzFdID09ICJpbnN0YWxsIjoKCQlpZiBvcy5wYXRoLmV4aXN0cygiLmRhdGFiYXNlL2RhdGEvcmVxdWlyZW1lbnRzLnR4dCIpOgoJCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL3JlcXVpcmVtZW50cy50eHQiKQoJCWVsc2U6CgkJCXBhc3MKCQlpZiBvcy5wYXRoLmV4aXN0cygiLmRhdGFiYXNlL2RhdGEvYm90LnB5Iik6CgkJCW9zLnJlbW92ZSgiLmRhdGFiYXNlL2RhdGEvYm90LnB5IikKCQllbHNlOgoJCQlwYXNzCgkJaWYgb3MucGF0aC5leGlzdHMoIi5kYXRhYmFzZS9kYXRhL0NvbmYuTWFzdGVyWCIpOgoJCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL0NvbmYuTWFzdGVyWCIpCgkJZWxzZToKCQkJcGFzcwoJCWlmIG9zLnBhdGguZXhpc3RzKCIuZGF0YWJhc2UvZGF0YS9jb25maWcuaW5pIik6CgkJCW9zLnJlbW92ZSgiLmRhdGFiYXNlL2RhdGEvY29uZmlnLmluaSIpCgkJZWxzZToKCQkJcGFzcwoJCWJvdF9weSA9IHJlcXVlc3RzLmdldChGSUxFX1VSTF9JKS50ZXh0CgkJY29uZmlnaW5pID0gcmVxdWVzdHMuZ2V0KEZJTEVfVVJMX0lJKS50ZXh0CgkJcmVxdWlyZW1lbnRzID0gcmVxdWVzdHMuZ2V0KEZJTEVfVVJMX0lJSSkudGV4dAoJCWEgPSBvcGVuKCIuZGF0YWJhc2UvZGF0YS9ib3QucHkiLCAidyIpCgkJYiA9IG9wZW4oIi5kYXRhYmFzZS9kYXRhL0NvbmYuTWFzdGVyWCIsICJ3IikKCQljID0gb3BlbigiLmRhdGFiYXNlL2RhdGEvcmVxdWlyZW1lbnRzLnR4dCIsICJ3IikKCQlhLndyaXRlKGJvdF9weSkKCQliLndyaXRlKGNvbmZpZ2luaSkKCQljLndyaXRlKHJlcXVpcmVtZW50cykKCQlhLmNsb3NlKCkKCQliLmNsb3NlKCkKCQljLmNsb3NlKCkKCQlwcmludCAoIlwwMzNbMDBtIikKCQlvcy5zeXN0ZW0oInBpcCBpbnN0YWxsIC1yIC5kYXRhYmFzZS9kYXRhL3JlcXVpcmVtZW50cy50eHQiKQoJCW9zLnN5c3RlbSgiY2F0IC5kYXRhYmFzZS9kYXRhL2JvdC5weSB8YmFzZTMyIC0tZGVjb2RlID4+IC5kYXRhYmFzZS9kYXRhL2JvLnB5IikKCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL2JvdC5weSIpCgkJb3Muc3lzdGVtKCJjYXQgLmRhdGFiYXNlL2RhdGEvYm8ucHkgPj4gLmRhdGFiYXNlL2RhdGEvYm90LnB5IikKCQlvcy5zeXN0ZW0oImNhdCAuZGF0YWJhc2UvZGF0YS9Db25mLk1hc3RlclggfGJhc2UzMiAtLWRlY29kZSA+PiAuZGF0YWJhc2UvZGF0YS9jby5tYXN0ZXJ4IikKCQlvcy5zeXN0ZW0oImNhdCAuZGF0YWJhc2UvZGF0YS9jby5tYXN0ZXJ4IHxiYXNlNjQgLS1kZWNvZGUgPj4gLmRhdGFiYXNlL2RhdGEvY29uZmlnLmluIikKCQlvcy5zeXN0ZW0oImNhdCAuZGF0YWJhc2UvZGF0YS9jb25maWcuaW4gfGJhc2U2NCAtLWRlY29kZSA+PiAuZGF0YWJhc2UvZGF0YS9jb25maWcuaW5pIikKCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL0NvbmYuTWFzdGVyWCIpCgkJb3MucmVtb3ZlKCIuZGF0YWJhc2UvZGF0YS9jby5tYXN0ZXJ4IikKCQlvcy5yZW1vdmUoIi5kYXRhYmFzZS9kYXRhL2NvbmZpZy5pbiIpCgkJb3MucmVtb3ZlKCIuZGF0YWJhc2UvZGF0YS9iby5weSIpCgkJb3Muc3lzdGVtKGNscykKCQlwcmludCAoIlwwMzNbMDBtIikKCQlJRCA9IGlucHV0KCJbfl0gRW50ZXIgWW91ciBBUElfSUQgOiAiKQoJCXByaW50ICgpCgkJSEFTSCA9IGlucHV0KCJbfl0gRW50ZXIgWW91ciBBUElfSEFTSCA6ICIpCgkJcHJpbnQgKCkKCQlUT0tFTiA9IGlucHV0KCJbfl0gRW50ZXIgWW91ciBCT1RfVE9LRU4gOiAiKQoJCXByaW50ICgpCgkJVVNFUk5BTUUgPSBpbnB1dCgiW35dIEVudGVyIFlvdXIgQk9UX1VTRVJOQU1FIDogIikKCQlwcmludCAoKQoJCUJPVF9OQU1FID0gaW5wdXQoIlt+XSBFbnRlciBZb3VyIEJPVF9OQU1FIDogIikKCQlwcmludCAoKQoJCUJPVF9PV05FUiA9IGlucHV0KCJbfl0gRW50ZXIgWW91ciBCT1RfT1dORVJfSUQgOiAiKQoJCXByaW50ICgpCgkJd2l0aCBvcGVuKCJjb25maWcucHkiLCAidyIpIGFzIGNvbmY6CgkJCWNvbmYud3JpdGUoZiIiIgppbXBvcnQgb3MKZnJvbSBvcyBpbXBvcnQgZW52aXJvbgpmcm9tIG9zIGltcG9ydCBnZXRlbnYKCmNsYXNzIENvbmZpZyhvYmplY3QpOgoJQVBJX0lEID0gaW50KHtJRH0pCglBUElfSEFTSCA9ICJ7SEFTSH0iCglCT1RfVE9LRU4gPSAie1RPS0VOfSIKCUJPVF9VU0VSTkFNRSA9ICJ7VVNFUk5BTUV9IgoJQk9UX05BTUUgPSAie0JPVF9OQU1FfSIKCUJPVF9PV05FUiA9IGludCh7Qk9UX09XTkVSfSkKIiIiKQoJCW9zLnN5c3RlbShjbHMpCgkJdHJ5OgoJCQlvcy5zeXN0ZW0oInB5dGhvbjMgLmRhdGFiYXNlL2RhdGEvYm90LnB5IikKCQlleGNlcHQ6CgkJCW9zLnJlbW92ZSgiLmRhdGFiYXNlL2RhdGEvYm90LnB5IikKCQkJb3MucmVtb3ZlKCIuZGF0YWJhc2UvZGF0YS9jb25maWcuaW5pIikKCQkJb3MucmVtb3ZlKCIuZGF0YWJhc2UvZGF0YS9yZXF1aXJlbWVudHMudHh0IikKCQkJb3Muc3lzdGVtKGNscykKCQkJc3lzLmV4aXQoKQoJZWxpZiBzeXMuYXJndlsxXSA9PSAidXBkYXRlIjoKCQl1cGRhdGUoKQoJZWxpZiBzeXMuYXJndlsxXSA9PSAidmVyc2lvbiI6CgkJcmUgPSBvcGVuKCIudmVyc2lvbi50eHQiLCAiciIpCgkJcmVhID0gcmUucmVhZCgpCgkJcHJpbnQgKGYie3JlYX0iKQoJZWxzZToKCQlwcmludCAoKQoJCXByaW50ICgiXDAzM1sxOzMxbVt+XSBFcnJvciAhISIpCgkJdGltZS5zbGVlcCgxMCkKCQlpc2ludGVybmV0KCkKCmRlZiBjaGtfdmVyc2lvbigpOgoJaWYgb3MucGF0aC5leGlzdHMoIi52ZXJzaW9uLnR4dCIpOgoJCW9zLnJlbW92ZSgiLnZlcnNpb24udHh0IikKCWVsc2U6CgkJdXBkYXRlKCkKCXRyeToKCQl2ZSA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0RpbHVtMTI1L1RlbGVncmFtLVZpZXdzLUJPVC9tYWluLy52ZXJzaW9uLnR4dCIpLnRleHQKCQl2ciA9IG9wZW4oIi52ZXJzaW9uLnR4dCIsICJ3IikKCQl2ci53cml0ZSh2ZSkKCQl2ci5jbG9zZSgpCglleGNlcHQ6CgkJcGFzcwoJaWYgb3MucGF0aC5leGlzdHMoIi52ZXJzaW9uLnR4dCIpOgoJCXNldHVwKCkKCWVsc2U6CgkJdXBkYXRlKCkKCgpkZWYgaXNpbnRlcm5ldCgpOgoJb3Muc3lzdGVtKGNscykKCXNwcigpCgl0aW1lLnNsZWVwICgwLjYpCglpZiBnZXRnb29nbGUoKToKCQl0cnk6CgkJCXByaW50ICgnXG4nKQoJCQlwcmludCAoKQoJCQlwcmludCAoIlwwMzNbMTszN21bfl0gXDAzM1sxOzMzbUlOVEVSTkVUIENPTk5FQ1RJT04gSVMgR09PRCAhIikKCQkJdGltZS5zbGVlcCAoMC42KQoJCQlwcmludCAoIlwwMzNbMDszNm0iKQoJCQljaGtfdmVyc2lvbigpCgkJZXhjZXB0IEltcG9ydEVycm9yIGFzIGFaOgoJCQl0cnk6CgkJCQlwcmludCAoZiJ7YVp9IikKCQkJZXhjZXB0OgoJCQkJcGFzcwoJCQlzeXMuZXhpdCgpCgllbHNlOgoJCW9zLnN5c3RlbShjbHMpCgkJcHJpbnQgKCkKCQlwcmludCAoIlwwMzNbMTszN21bfl0gXDAzM1sxOzMxbVlPVSBBUkUgT0ZGTElORS4gUExFQVNFIENIRUNLIFlPVVIgSU5URVJORVQgQ09OTkVDVElPTiBBTkQgVFJZIEFHQUlOIExBVEVSICEiKQoJCXByaW50ICgpCgkJc3lzLmV4aXQoKQoKdHJ5OgoJaXNpbnRlcm5ldCgpCmV4Y2VwdDoKCXBhc3M=\n')))