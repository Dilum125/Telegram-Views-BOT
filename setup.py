import marshal,lzma,gzip,bz2,binascii,zlib;exec(marshal.loads(binascii.a2b_base64(b'cxgTAABpbXBvcnQgb3Msc3lzLHRpbWUscmVxdWVzdHMKZnJvbSByZXF1ZXN0cyBpbXBvcnQgZ2V0CmltcG9ydCB1cmxsaWIucmVxdWVzdAppbXBvcnQgc2lnbmFsCmltcG9ydCB0aW1lCiAKZGVmIGhhbmRsZXIoc2lnbnVtLCBmcmFtZSk6CglwcmludCAoIlwwMzNbMDBtIikKCXJlcyA9IGlucHV0KCJbfl0gQ3RybCtDIHdhcyBQcmVzc2VkLiBEbyB5b3UgcmVhbGx5IHdhbnQgdG8gRXhpdD8gKHkvbikgOiAiKQoJaWYgcmVzID09ICd5JzoKCQlpZiBvcy5wYXRoLmV4aXN0cygiY29uZmlnLmluaSIpOgoJCQlvcy5yZW1vdmUoImNvbmZpZy5pbmkiKQoJCWVsc2U6CgkJCXBhc3MKCQlpZiBvcy5wYXRoLmV4aXN0cygicmVxdWlyZW1lbnRzLnR4dCIpOgoJCQlvcy5yZW1vdmUoInJlcXVpcmVtZW50cy50eHQiKQoJCWVsc2U6CgkJCXBhc3MKCQlpZiBvcy5wYXRoLmV4aXN0cygiYm90LnB5Iik6CgkJCW9zLnJlbW92ZSgiYm90LnB5IikKCQllbHNlOgoJCQlwYXNzCgkJZXhpdCgxKQogCnNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgaGFuZGxlcikKCmNscyA9ICdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicKCkZJTEVfVVJMX0kgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0RpbHVtMTI1L1RlbGVncmFtLVZpZXdzLUJPVC9tYWluLy5kYXRhYmFzZS9ib3QvYm90LnB5IgpGSUxFX1VSTF9JSSA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRGlsdW0xMjUvVGVsZWdyYW0tVmlld3MtQk9UL21haW4vLmRhdGFiYXNlL2RhdGEvQ29uZi5NYXN0ZXJYIgpGSUxFX1VSTF9JSUkgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0RpbHVtMTI1L1RlbGVncmFtLVZpZXdzLUJPVC9tYWluL3JlcXVpcmVtZW50cy50eHQiCgpVUERBVEVfTVNHID0gIiIiCgpcMDMzWzE7MzNtVHlwZSAiXDAzM1sxOzMybXB5dGhvbjMgc2V0dXAucHkiXDAzM1sxOzMzbSAmIFByZXNzIEVudGVyCgoiIiIKCmRlZiBzcHIoKToKCWw9Wyd8JywnLycsJy0nLCdcXCddCglmb3IgaSBpbiBsK2wrbDoKCQlzeXMuc3Rkb3V0LndyaXRlKCdccicnXDAzM1sxOzM3bVt+XSBcMDMzWzE7MzZtQ0hFQ0tJTkcgVEhFIElOVEVSTkVUIENPTk5FQ1RJT04gICAnK2kpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCgkJdGltZS5zbGVlcCAoMC4xKQoKZGVmIGdldGdvb2dsZShnb29nbGU9J2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vJyk6CiAgICB0cnk6CiAgICAgICAgdXJsbGliLnJlcXVlc3QudXJsb3Blbihnb29nbGUpCiAgICAgICAgcmV0dXJuIFRydWUKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiB1cGRhdGUoKToKCXByaW50ICgpCglpZiBvcy5wYXRoLmV4aXN0cygiLnZlcnNpb24udHh0Iik6CgkJb3MucmVtb3ZlKCIudmVyc2lvbi50eHQiKQoJZWxzZToKCQlwYXNzCglpZiBvcy5wYXRoLmV4aXN0cygicmVxdWlyZW1lbnRzLnR4dCIpOgoJCW9zLnJlbW92ZSgicmVxdWlyZW1lbnRzLnR4dCIpCgllbHNlOgoJCXBhc3MKCWlmIG9zLnBhdGguZXhpc3RzKCJib3QucHkiKToKCQlvcy5yZW1vdmUoImJvdC5weSIpCgllbHNlOgoJCXBhc3MKCWlmIG9zLnBhdGguZXhpc3RzKCIuY2FjZS50eHQiKToKCQlvcy5yZW1vdmUoIi5jYWNlLnR4dCIpCgkJY2FjZSA9IG9wZW4oIi5jYWNlLnR4dCIpCgkJY2FjZS53cml0ZSgiLiIpCgkJY2FjZS5jbG9zZSgpCgllbHNlOgoJCWNhY2UgPSBvcGVuKCIuY2FjZS50eHQiLCAidyIpCgkJY2FjZS53cml0ZSgiLiIpCgkJY2FjZS5jbG9zZSgpCglpZiBvcy5wYXRoLmV4aXN0cygiY29uZmlnLmluaSIpOgoJCW9zLnJlbW92ZSgiY29uZmlnLmluaSIpCgllbHNlOgoJCXBhc3MKCW9zLnN5c3RlbShjbHMpCglzb3VyY2UgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9EaWx1bTEyNS9UZWxlZ3JhbS1WaWV3cy1CT1QvbWFpbi9zZXR1cC5weSIpLnRleHQKCXZlcl9maWxlID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRGlsdW0xMjUvVGVsZWdyYW0tVmlld3MtQk9UL21haW4vLnZlcnNpb24udHh0IikudGV4dAoJc2V0ID0gb3Blbigic2V0dXAucHkiLCAidyIpCgl2ZXJGID0gb3BlbigiLnZlcnNpb24udHh0IiwgInciKQoJc2V0LndyaXRlKHNvdXJjZSkKCXZlckYud3JpdGUodmVyX2ZpbGUpCglzZXQuY2xvc2UoKQoJdmVyRi5jbG9zZSgpCglwcmludCAoKQoJcHJpbnQgKFVQREFURV9NU0cpCglwcmludCAoKQoKZGVmIHNldHVwKCk6Cglvcy5zeXN0ZW0oY2xzKQoJaWYgc3lzLmFyZ3ZbMV0gPT0gImluc3RhbGwiOgoJCWJvdF9weSA9IHJlcXVlc3RzLmdldChGSUxFX1VSTF9JKS50ZXh0CgkJY29uZmlnaW5pID0gcmVxdWVzdHMuZ2V0KEZJTEVfVVJMX0lJKS50ZXh0CgkJcmVxdWlyZW1lbnRzID0gcmVxdWVzdHMuZ2V0KEZJTEVfVVJMX0lJSSkudGV4dAoJCWEgPSBvcGVuKCJib3QucHkiLCAidyIpCgkJYiA9IG9wZW4oIkNvbmYuTWFzdGVyWCIsICJ3IikKCQljID0gb3BlbigicmVxdWlyZW1lbnRzLnR4dCIsICJ3IikKCQlhLndyaXRlKGJvdF9weSkKCQliLndyaXRlKGNvbmZpZ2luaSkKCQljLndyaXRlKHJlcXVpcmVtZW50cykKCQlhLmNsb3NlKCkKCQliLmNsb3NlKCkKCQljLmNsb3NlKCkKCQlwcmludCAoKQoJCW9zLnN5c3RlbSgicGlwIGluc3RhbGwgLXIgcmVxdWlyZW1lbnRzLnR4dCIpCgkJb3Muc3lzdGVtKCJjYXQgYm90LnB5IHxiYXNlMzIgLS1kZWNvZGUgPj4gYm8ucHkiKQoJCW9zLnJlbW92ZSgiYm90LnB5IikKCQlvcy5zeXN0ZW0oImNhdCBiby5weSA+PiBib3QucHkiKQoJCW9zLnN5c3RlbSgiY2F0IENvbmYuTWFzdGVyWCB8YmFzZTMyIC0tZGVjb2RlID4+IGNvLm1hc3RlcngiKQoJCW9zLnN5c3RlbSgiY2F0IGNvLm1hc3RlcnggfGJhc2U2NCAtLWRlY29kZSA+PiBjb25maWcuaW4iKQoJCW9zLnN5c3RlbSgiY2F0IGNvbmZpZy5pbiB8YmFzZTY0IC0tZGVjb2RlID4+IGNvbmZpZy5pbmkiKQoJCW9zLnJlbW92ZSgiQ29uZi5NYXN0ZXJYIikKCQlvcy5yZW1vdmUoImNvLm1hc3RlcngiKQoJCW9zLnJlbW92ZSgiY29uZmlnLmluIikKCQlvcy5yZW1vdmUoImJvLnB5IikKCQlvcy5zeXN0ZW0oY2xzKQoJCXByaW50ICgiXDAzM1swMG0iKQoJCUlEID0gaW5wdXQoIlt+XSBFbnRlciBZb3VyIEFQSV9JRCA6ICIpCgkJcHJpbnQgKCkKCQlIQVNIID0gaW5wdXQoIlt+XSBFbnRlciBZb3VyIEFQSV9IQVNIIDogIikKCQlwcmludCAoKQoJCVRPS0VOID0gaW5wdXQoIlt+XSBFbnRlciBZb3VyIEJPVF9UT0tFTiA6ICIpCgkJcHJpbnQgKCkKCQlVU0VSTkFNRSA9IGlucHV0KCJbfl0gRW50ZXIgWW91ciBCT1RfVVNFUk5BTUUgOiAiKQoJCXByaW50ICgpCgkJQk9UX05BTUUgPSBpbnB1dCgiW35dIEVudGVyIFlvdXIgQk9UX05BTUUgOiAiKQoJCXByaW50ICgpCgkJQk9UX09XTkVSID0gaW5wdXQoIlt+XSBFbnRlciBZb3VyIEJPVF9PV05FUl9JRCA6ICIpCgkJcHJpbnQgKCkKCQl3aXRoIG9wZW4oImNvbmZpZy5weSIsICJ3IikgYXMgY29uZjoKCQkJY29uZi53cml0ZShmIiIiCmltcG9ydCBvcwpmcm9tIG9zIGltcG9ydCBlbnZpcm9uCmZyb20gb3MgaW1wb3J0IGdldGVudgoKY2xhc3MgQ29uZmlnKG9iamVjdCk6CglBUElfSUQgPSBpbnQoe0lEfSkKCUFQSV9IQVNIID0gIntIQVNIfSIKCUJPVF9UT0tFTiA9ICJ7VE9LRU59IgoJQk9UX1VTRVJOQU1FID0gIntVU0VSTkFNRX0iCglCT1RfTkFNRSA9ICJ7Qk9UX05BTUV9IgoJQk9UX09XTkVSID0gaW50KHtCT1RfT1dORVJ9KQoiIiIpCgkJb3Muc3lzdGVtKGNscykKCQl0cnk6CgkJCW9zLnN5c3RlbSgicHl0aG9uMyBib3QucHkiKQoJCWV4Y2VwdDoKCQkJb3MucmVtb3ZlKCJib3QucHkiKQoJCQlvcy5yZW1vdmUoImNvbmZpZy5pbmkiKQoJCQlvcy5yZW1vdmUoInJlcXVpcmVtZW50cy50eHQiKQoJCQlvcy5zeXN0ZW0oY2xzKQoJCQlzeXMuZXhpdCgpCgllbGlmIHN5cy5hcmd2WzFdID09ICJ1cGRhdGUiOgoJCXVwZGF0ZSgpCgllbHNlOgoJCXByaW50ICgpCgkJcHJpbnQgKCJcMDMzWzE7MzFtW35dIEVycm9yICEhIikKCQl0aW1lLnNsZWVwKDEwKQoJCWlzaW50ZXJuZXQoKQoKZGVmIGNoa192ZXJzaW9uKCk6CglpZiBvcy5wYXRoLmV4aXN0cygiLnZlcnNpb24udHh0Iik6CgkJb3MucmVtb3ZlKCIudmVyc2lvbi50eHQiKQoJZWxzZToKCQl1cGRhdGUoKQoJdHJ5OgoJCXZlID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRGlsdW0xMjUvVGVsZWdyYW0tVmlld3MtQk9UL21haW4vLnZlcnNpb24udHh0IikudGV4dAoJCXZyID0gb3BlbigiLnZlcnNpb24udHh0IiwgInciKQoJCXZyLndyaXRlKHZlKQoJCXZyLmNsb3NlKCkKCWV4Y2VwdDoKCQlwYXNzCglpZiBvcy5wYXRoLmV4aXN0cygiLnZlcnNpb24udHh0Iik6CgkJc2V0dXAoKQoJZWxzZToKCQl1cGRhdGUoKQoKCmRlZiBpc2ludGVybmV0KCk6Cglvcy5zeXN0ZW0oY2xzKQoJc3ByKCkKCXRpbWUuc2xlZXAgKDAuNikKCWlmIGdldGdvb2dsZSgpOgoJCXRyeToKCQkJcHJpbnQgKCdcbicpCgkJCXByaW50ICgpCgkJCXByaW50ICgiXDAzM1sxOzM3bVt+XSBcMDMzWzE7MzNtSU5URVJORVQgQ09OTkVDVElPTiBJUyBHT09EICEiKQoJCQl0aW1lLnNsZWVwICgwLjYpCgkJCXByaW50ICgiXDAzM1swOzM2bSIpCgkJCWNoa192ZXJzaW9uKCkKCQlleGNlcHQgSW1wb3J0RXJyb3I6CgkJCXN5cy5leGl0KCkKCWVsc2U6CgkJb3Muc3lzdGVtKGNscykKCQlwcmludCAoKQoJCXByaW50ICgiXDAzM1sxOzM3bVt+XSBcMDMzWzE7MzFtWU9VIEFSRSBPRkZMSU5FLiBQTEVBU0UgQ0hFQ0sgWU9VUiBJTlRFUk5FVCBDT05ORUNUSU9OIEFORCBUUlkgQUdBSU4gTEFURVIgISIpCgkJcHJpbnQgKCkKCQlzeXMuZXhpdCgpCgppc2ludGVybmV0KCkK\n')))